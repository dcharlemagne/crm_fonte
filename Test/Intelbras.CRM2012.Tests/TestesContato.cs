using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using NUnit.Framework;
using System.DirectoryServices.AccountManagement;
using System.ServiceModel.Description;

namespace Intelbras.CRM2013.Tests
{
    [TestClass]
    [TestFixture]
    public class TestesContato : Base
    {
        [TestMethod]
        public void TestUploadImagemContato()
        {
            var service = new Domain.Servicos.ContatoService(this.OrganizationName, this.IsOffline);
            // new Guid("8C69D160-7F68-E711-80CB-0050568DED44")
            var contato = service.BuscaContato(new Guid("6E92D000-8E49-E411-9424-00155D013D3A"));

            var photoBase64 = "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";
            contato.Imagem = Convert.FromBase64String(photoBase64);
            //contato.Imagem = File.ReadAllBytes(@"c:\temp\diego.jpg");

            service.Persistir(contato);         
        }
    }
}
